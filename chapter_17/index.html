<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Eloquent Javascript</title>
  <link rel="icon" href="../html.ico">
  <link rel="stylesheet" href="./main.css">
</head>

<body>
  <h1>Hello World!</h1>
  <p>Normal HTML here</p>
  <svg xmlns="http://www.w3.org/2000/svg">
    <circle r="50" cx="50" cy="50" fill="red" />
    <rect x="120" y="5" width="90" height="90" stroke="blue" fill="none" />
  </svg>
  <script src="./main.js"></script>

  <p>Before canvas.</p>
  <canvas class="canvas1" width="120" height="60"></canvas>
  <p>After canvas.</p>
  <script>
    let canvas = document.querySelector(".canvas1");
    let context = canvas.getContext("2d");
    context.fillStyle = "red";
    context.fillRect(10, 10, 100, 50);
  </script>
  <canvas class="canvas2"></canvas>
  <script>
    let cx = document.querySelector(".canvas2").getContext("2d");
    cx.strokeStyle = "blue";
    cx.strokeRect(5, 5, 50, 50);
    cx.lineWidth = 5;
    cx.strokeRect(135, 5, 50, 50);
  </script>

  <canvas class="canvas3"></canvas>
  <script>
    cx = document.querySelector(".canvas3").getContext("2d");
    cx.beginPath();
    for (let y = 10; y < 100; y += 10) {
      cx.moveTo(10, y);
      cx.lineTo(90, y);
    }
    cx.stroke();
  </script>
  <canvas class="canvas4"></canvas>
  <script>
    cx = document.querySelector(".canvas4").getContext("2d");
    cx.beginPath();
    cx.moveTo(50, 10);
    cx.lineTo(10, 70);
    cx.lineTo(90, 70);
    cx.fill();
  </script>
  <canvas class="canvas5"></canvas>
  <script>
    cx = document.querySelector(".canvas5").getContext("2d");
    cx.beginPath();
    cx.moveTo(10, 90);
    cx.quadraticCurveTo(60, 10, 90, 90);
    cx.lineTo(60, 10);
    cx.closePath();
    cx.stroke();
  </script>
  <canvas class="canvas6"></canvas>
  <script>
    cx = document.querySelector(".canvas6").getContext("2d"); cx.beginPath();
    cx.moveTo(10, 90);
    // control1=(10,10) control2=(90,10) goal=(50,90)
    cx.bezierCurveTo(10, 10, 90, 10, 50, 90);
    cx.lineTo(90, 10);
    cx.lineTo(10, 10);
    cx.closePath();
    cx.stroke();
  </script>
  <canvas class="canvas7"></canvas>
  <script>
    cx = document.querySelector(".canvas7").getContext("2d");
    cx.beginPath();
    // center=(50,50) radius=40 angle=0 to 7
    cx.arc(50, 50, 40, 0, 7);
    // center=(150,50) radius=40 angle=0 to π1⁄2
    cx.arc(150, 50, 40, 0, 0.5 * Math.PI);
    cx.stroke();
  </script>
  <canvas class="canvas8" width="200" height="200"></canvas>
  <script>
    const results = [
      { name: "Satisfied", count: 1043, color: "lightblue" },
      { name: "Neutral", count: 563, color: "lightgreen" },
      { name: "Unsatisfied", count: 510, color: "pink" },
      { name: "No comment", count: 175, color: "silver" }
    ];

    cx = document.querySelector(".canvas8").getContext("2d");
    let total = results.reduce((sum, { count }) => sum + count, 0);
    // Start at the top
    let currentAngle = -0.5 * Math.PI;
    for (let result of results) {
      let sliceAngle = (result.count / total) * 2 * Math.PI; cx.beginPath();
      // center=100,100, radius=100
      // from current angle, clockwise by slice's angle
      cx.arc(100, 100, 100, currentAngle, currentAngle + sliceAngle);
      currentAngle += sliceAngle;
      cx.lineTo(100, 100);
      cx.fillStyle = result.color;
      cx.fill();
    }
  </script>
  <canvas class="canvas9"></canvas>
  <script>
    cx = document.querySelector(".canvas9").getContext("2d");
    cx.font = "28px Georgia";
    cx.fillStyle = "fuchsia";
    cx.fillText("I can draw text, too!", 10, 50);
  </script>
  <canvas class="canvas10"></canvas>
  <script>
    cx = document.querySelector(".canvas10").getContext("2d");
    let img = document.createElement("img");
    img.src = "../chapter_14/assets/hat.png";
    img.addEventListener("load", () => {
      for (let x = 10; x < 200; x += 30) {
        cx.drawImage(img, x, 10);
      }
    });
  </script>
  <canvas class="canvas11"></canvas>
  <script>
    let cx11 = document.querySelector(".canvas11").getContext("2d");
    let image = document.createElement("img");
    image.src = "assets/player.png";
    let spriteW = 24, spriteH = 30;
    image.addEventListener("load", () => {
      let cycle = 0;
      setInterval(() => {
        cx11.clearRect(0, 0, spriteW, spriteH);
        cx11.drawImage(image,
          // source rectangle
          cycle * spriteW, 0, spriteW, spriteH,
          // destination rectangle
          0, 0, spriteW, spriteH);
        cycle = (cycle + 1) % 8;
      }, 120);
    });
  </script>
  <canvas class="canvas12"></canvas>
  <script>
    let cx12 = document.querySelector(".canvas12").getContext("2d");
    cx12.scale(3, .5);
    cx12.beginPath();
    cx12.arc(50, 50, 40, 0, Math.PI);
    cx12.lineWidth = 3;
    cx12.stroke();
  </script>
  <canvas class="canvas13"></canvas>
  <script>
    let cx13 = document.querySelector(".canvas13").getContext("2d");
    cx13.scale(1, -1);
    cx13.strokeStyle = "blue";
    cx13.strokeRect(100, -50, 50, -50);
  </script>
  <canvas class="canvas14"></canvas>
  <script>
    let cx14 = document.querySelector(".canvas14").getContext("2d");
    cx14.translate(50, 50);
    cx14.rotate(0.4 * Math.PI);
    cx14.strokeStyle = "blue";
    cx14.strokeRect(0, 0, 50, 50);
  </script>
  <canvas class="canvas15"></canvas>
  <script>
    let cx15 = document.querySelector(".canvas15").getContext("2d");
    cx15.strokeStyle = "blue";
    cx15.translate(50, 50);
    cx15.rotate(0.1 * Math.PI);
    cx15.strokeRect(1, 1, 50, 50);
  </script>
  <canvas class="canvas16"></canvas>
  <script>
    let cx16 = document.querySelector(".canvas16").getContext("2d");
    function flipHorizontally(context, around) {
      context.translate(around, 0);
      context.scale(-1, 1);
      context.translate(-around, 0);
    }
    let img16 = document.createElement("img");
    img16.src = "./assets/player.png";
    let spriteW2 = 24, spriteH2 = 30; img16.addEventListener("load", () => {
      flipHorizontally(cx16, 100 + spriteW2 / 2);
      cx16.drawImage(img16, 0, 0, spriteW2, spriteH2,
        100, 0, spriteW2, spriteH2);
    });
  </script>
  <canvas class="canvas17" width="600" height="300"></canvas>
  <script>
    let cx17 = document.querySelector(".canvas17").getContext("2d");
    function branch(length, alpha, scale) {
     cx17.fillRect(0, 0, 1, length);
     if (length < 8) return;
     cx17.save();
     cx17.translate(0, length);
     cx17.rotate(-alpha);
     branch(length * scale, alpha, scale);
     cx17.rotate(2 * alpha);
     branch(length * scale, alpha, scale);
     cx17.restore();
   }
   cx17.translate(300, 0);
   branch(60, 0.5, 0.8);
  </script>
</body>

</html>